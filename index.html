<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Pro3D.sk | V√Ωpoƒçet ceny tlaƒçe</title>
    <style>
        :root { --bg:#f4f4f9; --card:white; --text:#333; --border:#ddd; --res-bg:#e7f3ff; --res-text:#007bff; --muted:rgba(0,0,0,0.55); }
        [data-theme="dark"]{ --bg:#121212; --card:#1e1e1e; --text:#e0e0e0; --border:#333; --res-bg:#1a2635; --res-text:#4da3ff; --muted:rgba(255,255,255,0.6); }
        html,body{height:100%;margin:0;}
        body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg); color:var(--text); display:flex; align-items:flex-start; justify-content:center; padding:20px; transition:0.2s;}
        .card{width:100%;max-width:640px;background:var(--card);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,0.06);box-sizing:border-box;}
        .logo-container{text-align:center;margin-bottom:12px;}
        .logo-container img{max-width:140px}
        label{display:block;font-size:0.75rem;font-weight:700;color:var(--muted);text-transform:uppercase;margin-top:8px}
        input,select{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px;font-size:1rem;box-sizing:border-box;background:var(--card);color:var(--text);outline:none}
        .row{display:flex;gap:10px;margin-top:8px}
        .row>div{flex:1}
        .result{margin-top:18px;padding:14px;background:var(--res-bg);border-radius:10px;border:1px solid var(--res-text);text-align:center}
        .total{font-size:2.2rem;font-weight:800;color:var(--res-text);margin-top:6px}
        .breakdown{font-size:0.9rem;margin-top:10px;text-align:left;line-height:1.45;border-top:1px solid rgba(0,0,0,0.06);padding-top:8px}
        .controls{display:flex;gap:8px;margin-top:14px}
        button{flex:1;padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
        .btn-reset{background:#ff4d4d;color:white}
        .btn-theme{background:#555;color:white}
        .elec-tag{display:inline-block;font-size:0.8rem;padding:3px 8px;border-radius:6px;margin-top:4px}
        .high-temp{background:#fff3cd;color:#856404}
        .small-note{font-size:0.85rem;color:var(--muted);margin-top:8px}
        .checkbox-row{display:flex;align-items:center;gap:8px;margin-top:10px}
        .checkbox-row input[type="checkbox"]{width:18px;height:18px}
        @media (max-width:480px){ .row{flex-direction:column} .controls{flex-direction:column} }
    </style>
</head>
<body data-theme="light">
<div class="card" role="application" aria-labelledby="title">
    <div class="logo-container">
        <img src="https://pro3d.sk/wp-content/uploads/2023/10/logo_pro3d_horizontal.png" alt="Pro3D Logo">
    </div>

    <h2 id="title" style="margin:0 0 8px 0;font-size:1.1rem">V√Ωpoƒçet ceny 3D tlaƒçe</h2>

    <label for="matType">Materi√°l a kvalita</label>
    <select id="matType" onchange="updateMaterialPrice()" aria-label="Materi√°l">
        <optgroup label="Standard">
            <option value="15" data-temp="low">PLA Standard</option>
            <option value="15" data-temp="low">PETG Standard</option>
            <option value="20" data-temp="high">ASA Standard</option>
            <option value="30" data-temp="high">PC Standard</option>
            <option value="25" data-temp="low">TPU Standard</option>
        </optgroup>
        <optgroup label="Profi / Brand">
            <option value="20" data-temp="low">PLA Profi</option>
            <option value="20" data-temp="low">PETG Profi</option>
            <option value="25" data-temp="high">ASA Profi</option>
            <option value="40" data-temp="high">PC Profi</option>
            <option value="40" data-temp="low">TPU Profi</option>
        </optgroup>
    </select>

    <div class="row" style="margin-top:6px">
        <div>
            <label for="matPriceInput">Cena materi√°lu (‚Ç¨/kg)</label>
            <input type="number" id="matPriceInput" value="15" step="0.5" min="0" oninput="calculatePrint()" aria-label="Cena materi√°lu">
        </div>
        <div>
            <label for="weight">V√°ha v g (zo slicera)</label>
            <input type="number" id="weight" value="50" min="0" oninput="calculatePrint()" aria-label="V√°ha v gramoch">
        </div>
    </div>

    <div class="row">
        <div>
            <label for="printTime">ƒåas tlaƒçe (hod)</label>
            <input type="number" id="printTime" value="2.5" step="0.1" min="0" oninput="calculatePrint()" aria-label="ƒåas tlaƒçe v hodin√°ch">
        </div>
        <div>
            <label for="workTime">Tvoja pr√°ca (min)</label>
            <input type="number" id="workTime" value="30" min="0" oninput="calculatePrint()" aria-label="Pr√°ca v min√∫tach">
        </div>
    </div>

    <div class="row">
        <div>
            <label for="margin">Mar≈æa / Zisk (%)</label>
            <input type="number" id="margin" value="0" step="0.1" min="0" oninput="calculatePrint()" aria-label="Mar≈æa v percent√°ch">
        </div>
        <div>
            <label for="adminFee">Fixn√Ω poplatok (‚Ç¨)</label>
            <input type="number" id="adminFee" value="0" step="0.1" min="0" oninput="calculatePrint()" aria-label="Fixn√Ω poplatok">
        </div>
    </div>

    <!-- AMS checkbox (default checked) -->
    <div class="checkbox-row">
        <input type="checkbox" id="amsCheckbox" checked onchange="calculatePrint()" aria-checked="true" />
        <label for="amsCheckbox" style="margin:0;font-size:0.95rem;font-weight:600;color:var(--text);text-transform:none">
            Pou≈æi≈• AMS (amortiz√°cia) ‚Äî pripoƒç√≠ta +0,10 ‚Ç¨/h k prev√°dzke stroja
        </label>
    </div>
    <div class="small-note">
        AMS: amortiz√°cia a √∫dr≈æba automatick√©ho syst√©mu (AM S). Prednastaven√© zapnut√© kv√¥li amortiz√°cii zariadenia.
    </div>

    <div class="result" aria-live="polite">
        <div id="tempBadge" class="elec-tag" aria-hidden="true"></div>
        <div style="font-weight:700;opacity:0.75;margin-top:6px">Celkov√° cena:</div>
        <div class="total" id="totalPrice">0.00 ‚Ç¨</div>
        <div id="breakdown" class="breakdown">Zadajte √∫daje...</div>
        <div class="small-note">
            V√Ωpoƒçty: Materi√°l = (v√°ha v g / 1000) √ó cena/kg √ó 1.1 (rezerva 10 %). Prev√°dzka stroja = ƒças tlaƒçe √ó hodinov√° sadzba (+ AMS ak zapnut√©). Pr√°ca = min√∫ty pr√°ce / 60 √ó hodinov√° sadzba.
        </div>
    </div>

    <div class="controls" role="group" aria-label="Ovl√°dacie tlaƒçidl√°">
        <button class="btn-reset" onclick="resetPrintCalc()" title="Nastav√≠ predvolen√© hodnoty">Vynulova≈•</button>
        <button class="btn-theme" onclick="toggleTheme()" title="Prepne svetl√Ω/temn√Ω re≈æim">Re≈æim üåì</button>
    </div>
</div>

<script>
/* PRINT CALC ONLY (with AMS option) */

// Update material price when selecting a material preset
function updateMaterialPrice() {
    const matSelect = document.getElementById('matType');
    const selectedPrice = matSelect.value;
    document.getElementById('matPriceInput').value = selectedPrice;
    calculatePrint();
}

// Theme toggle
function toggleTheme() {
    const body = document.body;
    body.setAttribute('data-theme', body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
}

// Reset: restore the requested defaults and keep AMS checked
function resetPrintCalc() {
    document.getElementById('matType').selectedIndex = 0;
    // mirror selected option into price input
    document.getElementById('matPriceInput').value = document.getElementById('matType').value;
    document.getElementById('printTime').value = 2.5;
    document.getElementById('weight').value = 50;
    document.getElementById('workTime').value = 30;
    document.getElementById('adminFee').value = 0;
    document.getElementById('margin').value = 0;
    // AMS default should be checked
    document.getElementById('amsCheckbox').checked = true;
    calculatePrint();
}

// Main calculation
function calculatePrint() {
    const matSelect = document.getElementById('matType');
    const tempType = matSelect.options[matSelect.selectedIndex].getAttribute('data-temp');

    // Rates (can be adjusted)
    const machineBase = 0.60; // ‚Ç¨/h for normal
    const highTempExtra = 0.15; // extra ‚Ç¨/h for high-temp materials
    const laborRate = 10.00; // ‚Ç¨/h labor
    const amsHourly = 0.10; // AMS amortization per hour (added when checkbox checked)

    const printTime = parseFloat(document.getElementById('printTime').value) || 0;
    const weight = parseFloat(document.getElementById('weight').value) || 0;
    const matPrice = parseFloat(document.getElementById('matPriceInput').value) || 0;
    const workTimeMin = parseFloat(document.getElementById('workTime').value) || 0;
    const marginPercent = parseFloat(document.getElementById('margin').value) || 0;
    const adminFee = parseFloat(document.getElementById('adminFee').value) || 0;
    const amsEnabled = !!document.getElementById('amsCheckbox').checked;

    // compute machine hourly rate including high-temp extra and AMS (if enabled)
    let currentMachineRate = machineBase;
    if (tempType === 'high') currentMachineRate += highTempExtra;
    if (amsEnabled) currentMachineRate += amsHourly;

    const costMachine = printTime * currentMachineRate;
    const costMat = (weight / 1000) * matPrice * 1.1; // 10% extra material margin
    const costLabor = (workTimeMin / 60) * laborRate;

    const totalCosts = costMachine + costMat + costLabor + adminFee;
    const finalPrice = totalCosts * (1 + (marginPercent / 100));

    const badge = document.getElementById('tempBadge');
    if (tempType === 'high') {
        badge.innerText = "‚ö° VYSOK√Å TEPLOTA";
        badge.className = "elec-tag high-temp";
    } else {
        badge.innerText = "‚ùÑÔ∏è BE≈ΩN√Å TEPLOTA";
        badge.className = "elec-tag";
    }

    if (totalCosts > 0 || adminFee > 0) {
        document.getElementById('totalPrice').innerText = finalPrice.toFixed(2) + " ‚Ç¨";
        document.getElementById('breakdown').innerHTML = `
            ‚Ä¢ Materi√°l (${matPrice.toFixed(2)} ‚Ç¨/kg + 10%): ${costMat.toFixed(2)} ‚Ç¨<br>
            ‚Ä¢ Prev√°dzka stroja (${currentMachineRate.toFixed(2)} ‚Ç¨/h): ${costMachine.toFixed(2)} ‚Ç¨${amsEnabled ? ' <span style="color:#555;font-size:0.85em"> (vr√°tane AMS +' + amsHourly.toFixed(2) + '‚Ç¨/h)</span>' : '' }<br>
            ‚Ä¢ Pr√°ca a pr√≠prava: ${costLabor.toFixed(2)} ‚Ç¨<br>
            ‚Ä¢ Fixn√Ω poplatok: ${adminFee.toFixed(2)} ‚Ç¨<br>
            <strong>‚Ä¢ N√°klady spolu: ${totalCosts.toFixed(2)} ‚Ç¨</strong>
        `;
    } else {
        document.getElementById('totalPrice').innerText = "0.00 ‚Ç¨";
        document.getElementById('breakdown').innerText = "Zadajte √∫daje zo Slicera...";
    }
}

// Initialize defaults on load
document.addEventListener('DOMContentLoaded', function () {
    // ensure price input matches selected material on first load
    document.getElementById('matPriceInput').value = document.getElementById('matType').value;
    // ensure AMS checkbox default is checked
    document.getElementById('amsCheckbox').checked = true;
    calculatePrint();
});
</script>
</body>
</html>
